{
	admin off
	email admin@project-saturn.com
}

# Authentication endpoint (no SSO protection)
auth.project-saturn.com {
	reverse_proxy authelia:9091
}

# Grafana (OAuth via application, not forward_auth)
grafana.project-saturn.com {
	reverse_proxy grafana:3000
}

# Adminer with SSO
adminer.project-saturn.com {
	forward_auth authelia:9091 {
		uri /api/verify?rd=https://auth.project-saturn.com/?rd=https://adminer.project-saturn.com
		copy_headers Remote-User Remote-Groups Remote-Name Remote-Email
	}
	reverse_proxy adminer:8080
}

# pgAdmin with SSO
pgadmin.project-saturn.com {
	forward_auth authelia:9091 {
		uri /api/verify?rd=https://auth.project-saturn.com/?rd=https://pgadmin.project-saturn.com
		copy_headers Remote-User Remote-Groups Remote-Name Remote-Email
	}
	reverse_proxy pgadmin:80
}

# Dockge with SSO
dockge.project-saturn.com {
	forward_auth authelia:9091 {
		uri /api/verify?rd=https://auth.project-saturn.com/?rd=https://dockge.project-saturn.com
		copy_headers Remote-User Remote-Groups Remote-Name Remote-Email
	}
	reverse_proxy dockge:5001
}

# LocalAI with SSO
localai.project-saturn.com {
	forward_auth authelia:9091 {
		uri /api/verify?rd=https://auth.project-saturn.com/?rd=https://localai.project-saturn.com
		copy_headers Remote-User Remote-Groups Remote-Name Remote-Email
	}
	reverse_proxy localai:8080
}

# LiteLLM with native OAuth (no forward_auth needed)
litellm.project-saturn.com {
	reverse_proxy litellm:4000
}

# Open WebUI with native OIDC (no forward_auth needed)
open-webui.project-saturn.com {
	reverse_proxy open-webui:8080
}

# Kopia with SSO
kopia.project-saturn.com {
	forward_auth authelia:9091 {
		uri /api/verify?rd=https://auth.project-saturn.com/?rd=https://kopia.project-saturn.com
		copy_headers Remote-User Remote-Groups Remote-Name Remote-Email
	}
	reverse_proxy kopia:51515
}

# Nextcloud with native OIDC (no forward_auth needed)
nextcloud.project-saturn.com {
	reverse_proxy nextcloud:80 {
		# Increase timeouts for large file uploads
		transport http {
			read_timeout 3600s
			write_timeout 3600s
		}
	}

	# Nextcloud specific headers
	header {
		Strict-Transport-Security "max-age=15552000;"
	}
}

# Vaultwarden with native OIDC (no forward_auth needed)
vaultwarden.project-saturn.com {
	reverse_proxy vaultwarden:80

	# Security headers for password manager
	header {
		Strict-Transport-Security "max-age=31536000;"
		X-Content-Type-Options "nosniff"
		X-Frame-Options "DENY"
	}
}

# Benthos with SSO
benthos.project-saturn.com {
	forward_auth authelia:9091 {
		uri /api/verify?rd=https://auth.project-saturn.com/?rd=https://benthos.project-saturn.com
		copy_headers Remote-User Remote-Groups Remote-Name Remote-Email
	}
	reverse_proxy benthos:4195
}

# FileBrowser with SSO via forward_auth
filebrowser.project-saturn.com {
	forward_auth authelia:9091 {
		uri /api/verify?rd=https://auth.project-saturn.com/?rd=https://filebrowser.project-saturn.com
		copy_headers Remote-User Remote-Groups Remote-Name Remote-Email
	}
	reverse_proxy filebrowser:8080
}

# Home Assistant with SSO via forward_auth
homeassistant.project-saturn.com {
	forward_auth authelia:9091 {
		uri /api/verify?rd=https://auth.project-saturn.com/?rd=https://homeassistant.project-saturn.com
		copy_headers Remote-User Remote-Groups Remote-Name Remote-Email
	}
	reverse_proxy homeassistant:8123
}

# Planka with native OIDC (no forward_auth needed)
planka.project-saturn.com {
	reverse_proxy planka:1337
}

# Outline with native OIDC (no forward_auth needed)
outline.project-saturn.com {
	reverse_proxy outline:3000
}

# Browserless with SSO
browserless.project-saturn.com {
	forward_auth authelia:9091 {
		uri /api/verify?rd=https://auth.project-saturn.com/?rd=https://browserless.project-saturn.com
		copy_headers Remote-User Remote-Groups Remote-Name Remote-Email
	}
	reverse_proxy browserless:3000
}

# CouchDB with SSO
couchdb.project-saturn.com {
	forward_auth authelia:9091 {
		uri /api/verify?rd=https://auth.project-saturn.com/?rd=https://couchdb.project-saturn.com
		copy_headers Remote-User Remote-Groups Remote-Name Remote-Email
	}
	reverse_proxy couchdb:5984
}

# ClickHouse with SSO
clickhouse.project-saturn.com {
	forward_auth authelia:9091 {
		uri /api/verify?rd=https://auth.project-saturn.com/?rd=https://clickhouse.project-saturn.com
		copy_headers Remote-User Remote-Groups Remote-Name Remote-Email
	}
	reverse_proxy clickhouse:8123
}

# JupyterHub with native OIDC (no forward_auth needed)
jupyterhub.project-saturn.com {
	reverse_proxy jupyterhub:8000
}

# Homepage Dashboard with SSO
homepage.project-saturn.com {
	forward_auth authelia:9091 {
		uri /api/verify?rd=https://auth.project-saturn.com/?rd=https://homepage.project-saturn.com
		copy_headers Remote-User Remote-Groups Remote-Name Remote-Email
	}
	reverse_proxy homepage:3000
}
