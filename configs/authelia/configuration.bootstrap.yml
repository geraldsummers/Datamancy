---
# ==============================================
# BOOTSTRAP CONFIG: project-saturn.com
# Production configuration with Let's Encrypt
# ==============================================
theme: dark
server:
  host: 0.0.0.0
  port: 9091
  endpoints:
    authz:
      forward-auth:
        implementation: ForwardAuth
    enable_pprof: false
    enable_expvars: false
  timeouts:
    read: 30s
    write: 30s
    idle: 120s

log:
  level: info
  format: text

totp:
  issuer: project-saturn.com
  period: 30
  skew: 1

authentication_backend:
  refresh_interval: 5m
  password_reset:
    disable: false
  ldap:
    implementation: custom
    url: ldap://ldap:389
    timeout: 5s
    start_tls: false
    base_dn: dc=stack,dc=local
    username_attribute: uid
    additional_users_dn: ou=users
    users_filter: (&({username_attribute}={input})(objectClass=inetOrgPerson))
    additional_groups_dn: ou=groups
    groups_filter: (&(member={dn})(objectClass=groupOfNames))
    group_name_attribute: cn
    mail_attribute: mail
    display_name_attribute: displayName
    user: cn=admin,dc=stack,dc=local

access_control:
  default_policy: deny
  rules:
    # Auth service itself needs bypass
    - domain: auth.project-saturn.com
      policy: bypass
    # All services accessible to authenticated users (one factor)
    - domain: "*.project-saturn.com"
      policy: one_factor
      subject:
        - "group:admins"
        - "group:users"

session:
  cookies:
    - domain: project-saturn.com
      name: authelia_session
      authelia_url: https://auth.project-saturn.com
      default_redirection_url: https://open-webui.project-saturn.com
      same_site: lax
      expiration: 24h
      inactivity: 2h
  remember_me: 1M
  redis:
    host: redis
    port: 6379
    database_index: 0

regulation:
  max_retries: 5
  find_time: 2m
  ban_time: 5m

storage:
  encryption_key: a_very_important_secret # Will be overridden by env var
  local:
    path: /config/db.sqlite3

notifier:
  disable_startup_check: true
  filesystem:
    filename: /config/notification.txt
