version: "3.9"

services:
  # Step 1/2 bits
  whoami:
    labels:
      caddy.tls: internal
  authelia:
    labels:
      caddy.tls: internal
  caddy-config:
    labels:
      # the base-domain vhost uses numbered labels
      caddy_2.tls: internal

  # Step 3: observability
  prometheus:
    labels:
      caddy.tls: internal
  alertmanager:
    labels:
      caddy.tls: internal
  loki:
    labels:
      caddy.tls: internal
  grafana:
    labels:
      caddy.tls: internal

  # Step 4: ops helpers
  portainer:
    labels:
      caddy.tls: internal
  netdata:
    labels:
      caddy.tls: internal

  # Step 6: AI core
  localai:
    labels:
      caddy.tls: internal

  # Step 7: chat/UI
  librechat:
    labels:
      caddy.tls: internal

  # Step 8: agent builder
  flowise:
    labels:
      caddy.tls: internal

  # Step 9: ingestion
  benthos:
    labels:
      caddy.tls: internal
  browserless:
    labels:
      caddy.tls: internal

  # Step 10: core apps
  nextcloud:
    labels:
      caddy.tls: internal
  vaultwarden:
    labels:
      caddy.tls: internal
  vikunja:
    labels:
      caddy.tls: internal
  jupyterhub:
    labels:
      caddy.tls: internal

  # Step 11: nice-to-haves
  jellyfin:
    labels:
      caddy.tls: internal
  qbittorrent:
    labels:
      caddy.tls: internal
  homeassistant:
    labels:
      caddy.tls: internal
