# Credential Rotation Metadata
# 60 credentials across 49 containers
# Tiers: 0 (weekly), 1 (bi-weekly), 2 (monthly), excluded (manual)

credentials:
  # ===========================
  # TIER 0: Weekly Rotation (12 credentials)
  # ===========================

  - name: POSTGRES_PASSWORD
    tier: 0
    rotation_frequency: weekly
    type: database
    affected_services: [postgres, all-services-with-db-access]
    downtime_expected: 0s
    dependencies: []
    rollback_priority: critical
    notes: "Root PostgreSQL password - rotate carefully"

  - name: AGENT_POSTGRES_OBSERVER_PASSWORD
    tier: 0
    rotation_frequency: weekly
    type: database
    affected_services: [agent-observer]
    downtime_expected: 0s
    dependencies: []
    rollback_priority: low
    notes: "Read-only account - safe to rotate"

  - name: GRAFANA_DB_PASSWORD
    tier: 0
    rotation_frequency: weekly
    type: database
    affected_services: [grafana]
    downtime_expected: 15s
    dependencies: [POSTGRES_PASSWORD]
    rollback_priority: medium
    notes: "Single service dependency"

  - name: DATAMANCY_SERVICE_PASSWORD
    tier: 0
    rotation_frequency: weekly
    type: database
    affected_services:
      - datamancy-agent-supervisor
      - datamancy-agent-code-writer
      - datamancy-agent-code-reader
      - datamancy-agent-data-fetcher
      - datamancy-agent-orchestrator
      - datamancy-agent-triage
      - datamancy-scheduler
      - datamancy-api
    downtime_expected: 120s
    dependencies: [POSTGRES_PASSWORD]
    rollback_priority: critical
    notes: "10+ services depend on this - critical rotation"

  - name: AUTHELIA_JWT_SECRET
    tier: 0
    rotation_frequency: weekly
    type: secret
    affected_services: [authelia]
    downtime_expected: 20s
    dependencies: []
    rollback_priority: critical
    notes: "JWT signing secret - users will need to re-login"

  - name: AUTHELIA_SESSION_SECRET
    tier: 0
    rotation_frequency: weekly
    type: secret
    affected_services: [authelia]
    downtime_expected: 20s
    dependencies: []
    rollback_priority: critical
    notes: "Session encryption - users will need to re-login"

  - name: AUTHELIA_STORAGE_ENCRYPTION_KEY
    tier: 0
    rotation_frequency: weekly
    type: secret
    affected_services: [authelia]
    downtime_expected: 20s
    dependencies: []
    rollback_priority: critical
    notes: "Storage encryption key"

  - name: AUTHELIA_OIDC_HMAC_SECRET
    tier: 0
    rotation_frequency: weekly
    type: secret
    affected_services: [authelia]
    downtime_expected: 20s
    dependencies: []
    rollback_priority: critical
    notes: "OIDC HMAC secret"

  - name: LDAP_ADMIN_PASSWORD
    tier: 0
    rotation_frequency: weekly
    type: ldap
    affected_services: [lldap, authelia]
    downtime_expected: 10s
    dependencies: []
    rollback_priority: high
    notes: "LDAP admin password"

  - name: LITELLM_MASTER_KEY
    tier: 0
    rotation_frequency: weekly
    type: api_key
    affected_services: [litellm, all-agent-services]
    downtime_expected: 30s
    dependencies: []
    rollback_priority: critical
    notes: "LiteLLM API master key - all agents depend on this"

  - name: QDRANT_API_KEY
    tier: 0
    rotation_frequency: weekly
    type: api_key
    affected_services: [qdrant, vector-search-services]
    downtime_expected: 15s
    dependencies: []
    rollback_priority: high
    notes: "Qdrant vector database API key"

  - name: STACK_ADMIN_PASSWORD
    tier: 0
    rotation_frequency: weekly
    type: admin
    affected_services: [qwen-stack-assistant]
    downtime_expected: 5s
    dependencies: []
    rollback_priority: medium
    notes: "Stack Admin password for Qwen assistant"

  # ===========================
  # TIER 1: Bi-weekly Rotation (20 credentials)
  # ===========================

  - name: REDIS_PASSWORD
    tier: 1
    rotation_frequency: bi-weekly
    type: database
    affected_services: [redis, authelia, caching-services]
    downtime_expected: 30s
    dependencies: []
    rollback_priority: high

  - name: NTFY_USERNAME
    tier: excluded
    rotation_frequency: manual
    type: config
    affected_services: [ntfy, alertmanager]
    downtime_expected: 0s
    dependencies: []
    rollback_priority: low
    notes: "Service account username for alertmanager"

  - name: NTFY_PASSWORD
    tier: 1
    rotation_frequency: bi-weekly
    type: service
    affected_services: [ntfy, alertmanager]
    downtime_expected: 10s
    dependencies: []
    rollback_priority: medium
    notes: "Service account password for alertmanager webhook authentication"

  - name: GRAFANA_ADMIN_PASSWORD
    tier: 1
    rotation_frequency: bi-weekly
    type: admin
    affected_services: [grafana]
    downtime_expected: 5s
    dependencies: []
    rollback_priority: medium

  - name: PROMETHEUS_PASSWORD
    tier: 1
    rotation_frequency: bi-weekly
    type: monitoring
    affected_services: [prometheus, grafana]
    downtime_expected: 15s
    dependencies: []
    rollback_priority: medium

  - name: LOKI_PASSWORD
    tier: 1
    rotation_frequency: bi-weekly
    type: monitoring
    affected_services: [loki, grafana]
    downtime_expected: 15s
    dependencies: []
    rollback_priority: medium

  - name: TRAEFIK_API_TOKEN
    tier: 1
    rotation_frequency: bi-weekly
    type: api_key
    affected_services: [traefik]
    downtime_expected: 10s
    dependencies: []
    rollback_priority: high
    notes: "Reverse proxy API token"

  # Additional Tier 1 credentials (14 more)
  - name: AGENT_SUPERVISOR_API_KEY
    tier: 1
    rotation_frequency: bi-weekly
    type: api_key

  - name: AGENT_CODE_WRITER_API_KEY
    tier: 1
    rotation_frequency: bi-weekly
    type: api_key

  - name: AGENT_CODE_READER_API_KEY
    tier: 1
    rotation_frequency: bi-weekly
    type: api_key

  - name: AGENT_DATA_FETCHER_API_KEY
    tier: 1
    rotation_frequency: bi-weekly
    type: api_key

  - name: AGENT_ORCHESTRATOR_API_KEY
    tier: 1
    rotation_frequency: bi-weekly
    type: api_key

  - name: AGENT_TRIAGE_API_KEY
    tier: 1
    rotation_frequency: bi-weekly
    type: api_key

  - name: SCHEDULER_API_KEY
    tier: 1
    rotation_frequency: bi-weekly
    type: api_key

  - name: API_SERVICE_KEY
    tier: 1
    rotation_frequency: bi-weekly
    type: api_key

  - name: WEBHOOK_SECRET
    tier: 1
    rotation_frequency: bi-weekly
    type: secret

  - name: ENCRYPTION_KEY_DATA
    tier: 1
    rotation_frequency: bi-weekly
    type: secret

  - name: ENCRYPTION_KEY_LOGS
    tier: 1
    rotation_frequency: bi-weekly
    type: secret

  - name: SESSION_SECRET_API
    tier: 1
    rotation_frequency: bi-weekly
    type: secret

  - name: CSRF_TOKEN_SECRET
    tier: 1
    rotation_frequency: bi-weekly
    type: secret

  - name: JWT_SECRET_API
    tier: 1
    rotation_frequency: bi-weekly
    type: secret

  # ===========================
  # TIER 2: Monthly Rotation (18 credentials)
  # ===========================

  - name: BACKUP_ENCRYPTION_KEY
    tier: 2
    rotation_frequency: monthly
    type: secret
    notes: "Used for backup encryption - rotate carefully"

  - name: S3_ACCESS_KEY
    tier: 2
    rotation_frequency: monthly
    type: cloud
    notes: "S3/MinIO access credentials"

  - name: S3_SECRET_KEY
    tier: 2
    rotation_frequency: monthly
    type: cloud

  - name: SMTP_PASSWORD
    tier: 2
    rotation_frequency: monthly
    type: email

  - name: GITHUB_TOKEN
    tier: 2
    rotation_frequency: monthly
    type: api_key
    notes: "GitHub API token for integrations"

  - name: GITLAB_TOKEN
    tier: 2
    rotation_frequency: monthly
    type: api_key

  - name: DISCORD_BOT_TOKEN
    tier: 2
    rotation_frequency: monthly
    type: api_key

  - name: SLACK_BOT_TOKEN
    tier: 2
    rotation_frequency: monthly
    type: api_key

  - name: OPENAI_API_KEY
    tier: 2
    rotation_frequency: monthly
    type: api_key
    notes: "External API - manual rotation via provider"

  - name: ANTHROPIC_API_KEY
    tier: 2
    rotation_frequency: monthly
    type: api_key
    notes: "External API - manual rotation via provider"

  - name: MONITORING_API_KEY
    tier: 2
    rotation_frequency: monthly
    type: api_key

  - name: METRICS_COLLECTOR_KEY
    tier: 2
    rotation_frequency: monthly
    type: api_key

  - name: LOG_AGGREGATOR_KEY
    tier: 2
    rotation_frequency: monthly
    type: api_key

  - name: ALERT_MANAGER_KEY
    tier: 2
    rotation_frequency: monthly
    type: api_key

  - name: CERTIFICATE_PASSWORD
    tier: 2
    rotation_frequency: monthly
    type: certificate

  - name: KEYSTORE_PASSWORD
    tier: 2
    rotation_frequency: monthly
    type: certificate

  - name: TRUSTSTORE_PASSWORD
    tier: 2
    rotation_frequency: monthly
    type: certificate

  - name: VPN_SHARED_SECRET
    tier: 2
    rotation_frequency: monthly
    type: secret

  # ===========================
  # EXCLUDED: Manual Rotation Only (8 credentials)
  # ===========================

  - name: AUTHELIA_OIDC_ISSUER_PRIVATE_KEY
    tier: excluded
    rotation_frequency: manual
    type: certificate
    notes: "RSA private key - too complex to rotate automatically"

  - name: VAPID_PUBLIC_KEY
    tier: excluded
    rotation_frequency: manual
    type: keypair
    notes: "Web Push VAPID keys - need coordinated client update"

  - name: VAPID_PRIVATE_KEY
    tier: excluded
    rotation_frequency: manual
    type: keypair
    notes: "Web Push VAPID keys - need coordinated client update"

  - name: SSH_PRIVATE_KEY
    tier: excluded
    rotation_frequency: manual
    type: keypair
    notes: "SSH keys require distribution"

  - name: GPG_PRIVATE_KEY
    tier: excluded
    rotation_frequency: manual
    type: keypair
    notes: "GPG keys require trust chain updates"

  - name: TLS_CERTIFICATE
    tier: excluded
    rotation_frequency: manual
    type: certificate
    notes: "Let's Encrypt auto-renewal handles this"

  - name: TLS_PRIVATE_KEY
    tier: excluded
    rotation_frequency: manual
    type: certificate
    notes: "Let's Encrypt auto-renewal handles this"

  - name: ROOT_CA_KEY
    tier: excluded
    rotation_frequency: manual
    type: certificate
    notes: "Root CA - never rotate automatically"

# Summary:
# Total: 60 credentials
# Tier 0 (weekly): 12 credentials
# Tier 1 (bi-weekly): 20 credentials
# Tier 2 (monthly): 18 credentials
# Excluded (manual): 8 credentials
# Automated: 50 credentials
