# Auto-generated from services.registry.yaml
# DO NOT EDIT MANUALLY - run scripts/codegen/generate-compose.main.kts

services:
  control-panel:
    build:
      dockerfile: ./src/control-panel/Dockerfile
      context: .
    container_name: control-panel
    ports:
      - "8097:8097"
    networks:
      frontend:
        aliases:
          - control.${DOMAIN}
      backend:
        aliases:
          - control.${DOMAIN}
      database:
        aliases:
          - control.${DOMAIN}
    depends_on:
      - postgres
      - data-fetcher
      - unified-indexer
    healthcheck:
      # Using Docker HEALTHCHECK from image
      interval: 30s
      timeout: 10s
      retries: 3
      start_period: 30s

  data-fetcher:
    build:
      dockerfile: ./src/data-fetcher/Dockerfile
      context: .
    container_name: data-fetcher
    networks:
      backend: {}
      database: {}
    depends_on:
      - postgres
      - clickhouse
      - bookstack
    healthcheck:
      # Using Docker HEALTHCHECK from image
      interval: 60s
      timeout: 10s
      retries: 3
      start_period: 30s

  unified-indexer:
    build:
      dockerfile: ./src/unified-indexer/Dockerfile
      context: .
    container_name: unified-indexer
    networks:
      backend: {}
      database: {}
      ai-gateway: {}
    depends_on:
      - postgres
      - bookstack
      - qdrant
      - clickhouse
      - embedding-service
    healthcheck:
      # Using Docker HEALTHCHECK from image
      interval: 30s
      timeout: 10s
      retries: 3
      start_period: 30s

  search-service:
    build:
      dockerfile: ./src/search-service/Dockerfile
      context: .
    container_name: search-service
    networks:
      backend: {}
      database: {}
      ai-gateway: {}
    depends_on:
      - qdrant
      - clickhouse
      - embedding-service
    healthcheck:
      # Using Docker HEALTHCHECK from image
      interval: 30s
      timeout: 10s
      retries: 3
      start_period: 30s

  datamancy-api-gateway:
    build:
      dockerfile: ./src/datamancy-api-gateway/Dockerfile
      context: .
    container_name: datamancy-api-gateway
    networks:
      ai-gateway: {}
      backend: {}
      database: {}
    depends_on:
      - postgres
      - mariadb
      - clickhouse
      - qdrant
      - ldap
    healthcheck:
      # Using Docker HEALTHCHECK from image
      interval: 30s
      timeout: 10s
      retries: 3
      start_period: 10s

  agent-tool-server:
    build:
      dockerfile: ./src/agent-tool-server/Dockerfile
      context: .
    container_name: agent-tool-server
    networks:
      ai:
        aliases:
          - agent-tool-server.${DOMAIN}
      ai-gateway:
        aliases:
          - agent-tool-server.${DOMAIN}
      frontend:
        aliases:
          - agent-tool-server.${DOMAIN}
    depends_on:
      - litellm
      - datamancy-api-gateway
    healthcheck:
      # Using Docker HEALTHCHECK from image
      interval: 30s
      timeout: 10s
      retries: 3
      start_period: 10s

  benthos:
    build:
      dockerfile: ./src/benthos/Dockerfile
      context: .
    container_name: benthos
    networks:
      backend: {}
      database: {}
    depends_on:
      - qdrant
      - clickhouse
      - litellm
    healthcheck:
      # Using Docker HEALTHCHECK from image
      interval: 30s
      timeout: 10s
      retries: 3
      start_period: 10s

