# Auto-generated by build-datamancy.main.kts
# Autoheal - Automatically restart unhealthy containers
# Image versions are HARDCODED at build time
# Only secrets and deployment paths use runtime ${VARS}

services:
  autoheal:
    image: willfarrell/autoheal:1.2.0
    container_name: autoheal
    restart: unless-stopped
    networks:
      - monitoring
    volumes:
      - /var/run/docker.sock:/var/run/docker.sock:ro
    environment:
      # Only restart containers labeled with autoheal=true
      AUTOHEAL_CONTAINER_LABEL: "autoheal"
      # Check every 30 seconds
      AUTOHEAL_INTERVAL: 30
      # Start healing after 2 consecutive unhealthy checks
      AUTOHEAL_START_PERIOD: 0
      # Restart unhealthy containers
      AUTOHEAL_DEFAULT_STOP_TIMEOUT: 10
      # Send webhook notifications
      WEBHOOK_URL: "http://ntfy:80/datamancy-autoheal"
